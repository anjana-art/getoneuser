import{d as M,r as S,N as A,o as i,a as n,e,F as D,v as x,t as E,D as F,E as K,_ as j,C as z,j as o,k as U,f as p,u as c,q as B,l as C,b as L,h as P,c as T,n as g,V as w,X as k}from"./app-FmU7_e9B.js";import{L as q,a as I,b as H}from"./lineChartData-DoIBklk7.js";import{A as X}from"./arrayUtil-B2mz7VJ2.js";import{E as N,a as O}from"./index-DKFN2YvA.js";import"./viewUtil-B5zuzifV.js";import"./_commonjsHelpers-Cpj98o6Y.js";import"./index-CGvgoY8n.js";import"./focus-trap-BpsD0gin.js";import"./index-DnsqOKfX.js";import"./isUndefined-DCTLXrZ8.js";import"./_baseIteratee-DKJhV95b.js";import"./isEqual-BzW8q1RT.js";import"./merge-DpnD1hi4.js";import"./_initCloneObject-brd83mMv.js";import"./isArrayLikeObject-BJavgoKj.js";import"./index-D0Za3L6V.js";const W=h=>(F("data-v-f9336731"),h=h(),K(),h),G={class:"pl-4"},J=W(()=>e("div",{class:"mb-2"}," Server Infos: ",-1)),R={class:"flex flex-col gap-y-1"},Y={class:"var-name"},Z={class:"select-all"},tt=M({__name:"MySQLBasic",props:{variableList:{}},setup(h){const s=h,t=S({}),f=[{name:"Port",value:"report_port"},{name:"Version",value:"version"},{name:"Slow Query Log",value:"slow_query_log"},{name:"Performance Schema",value:"performance_schema"},{name:"Base Directory",value:"basedir"},{name:"Data Directory",value:"datadir"}];A(()=>{t.value=X.arrayToObj(s.variableList.rows,a=>a.Variable_name,"Value")});const b=a=>t.value[a];return(a,v)=>(i(),n("div",G,[J,e("div",R,[(i(),n(D,null,x(f,_=>e("div",{key:_.name,class:"flex gap-x-2 flex-wrap shrink-0"},[e("div",Y,E(_.name)+":",1),e("div",Z,E(b(_.value)),1)])),64))])]))}}),et=j(tt,[["__scopeId","data-v-f9336731"]]),st={class:"pl-2 my-1"},at={class:"text-center"},it=M({__name:"Process",setup(h){const s=S(0),t=S({fields:[],rows:[],supportKill:!1});function f(a){return a.match(/SQL|INFO|SQL_TEXT/i)?null:a==="Host"?150:100}function b(a){o.emit("killProcess",a)}return z(()=>{o.on("processList",v=>{t.value=v}),o.emit("processList");const a=()=>{s.value=window.innerHeight-180};a(),window.addEventListener("resize",a)}),(a,v)=>{const _=U("vsc-button"),y=N,r=O;return i(),n("div",null,[e("div",st,[p(_,{type:"icon",icon:"codicon-refresh text-base",title:a.$t("common.refresh"),onClick:v[0]||(v[0]=u=>c(o).emit("processList"))},null,8,["title"])]),p(r,{data:t.value.rows,height:s.value,border:""},{default:B(()=>[(i(!0),n(D,null,x(t.value.fields,(u,l)=>(i(),C(y,{key:l,prop:u.name,label:u.name,align:"center",width:f(u.name)},null,8,["prop","label","width"]))),128)),t.value.supportKill?(i(),C(y,{key:0,label:"Action",align:"center",width:"70"},{default:B(({row:u})=>[e("div",at,[p(_,{type:"icon",icon:"codicon-debug-stop",class:"red",title:"Kill",onClick:l=>b(u)},null,8,["onClick"])])]),_:1})):L("",!0)]),_:1},8,["data","height"])])}}}),ot={class:"status-container"},lt={class:"tab"},nt={class:"flex flex-row",style:{height:"45vh","margin-top":"10px"}},rt={class:"basis-1/3"},ct={class:"basis-2/3"},ut=e("span",{class:"select-none"},"Traffic:",-1),dt={style:{height:"300px"}},pt={class:"flex"},vt={class:"basis-full"},_t=e("span",{class:"select-none"},"Queries:",-1),mt={style:{height:"300px"}},Qt=M({__name:"status",setup(h){const s=S("processList"),t=P({info:{dbType:null},process:{fields:[],rows:[]},variableList:{fields:[],rows:[]},statusList:{fields:[],rows:[]}}),f=new q,b=new q;function a(){r.dashBoard&&o.emit("dashBoard")}function v(){return window.outerHeight-180}const _=f.toChartData(),y=b.toChartData(),r=P({processList:!0,dashBoard:T(()=>["MariaDB","MySQL"].includes(t.info.dbType)),variableList:T(()=>["MariaDB","MySQL","PostgreSQL"].includes(t.info.dbType)),statusList:T(()=>["MariaDB","MySQL","PostgreSQL"].includes(t.info.dbType))});function u(){a(),o.emit("processList"),r.variableList&&o.emit("variableList"),r.statusList&&o.emit("statusList")}return o.on("info",l=>{t.info=l,r[s.value]||(s.value="processList"),u()}).on("variableList",l=>{t.variableList=l}).on("statusList",l=>{t.statusList=l}).on("dashBoard",l=>{b.addData(l.traffic),f.addData(l.queries)}).init("status"),window.addEventListener("focus",()=>{o.init("status")}),u(),setTimeout(()=>a(),1e3),setInterval(()=>a(),3e3),(l,m)=>{const Q=N,V=O;return i(),n("div",ot,[e("ul",lt,[r.dashBoard?(i(),n("li",{key:0,class:g(["tab__item",{"tab__item--active":s.value=="dashBoard"}]),onClick:m[0]||(m[0]=d=>{s.value="dashBoard",a()})}," Dashboard ",2)):L("",!0),r.processList?(i(),n("li",{key:1,class:g(["tab__item",{"tab__item--active":s.value=="processList"}]),onClick:m[1]||(m[1]=d=>{s.value="processList",c(o).emit("processList")})}," ProcessList ",2)):L("",!0),r.variableList?(i(),n("li",{key:2,class:g(["tab__item",{"tab__item--active":s.value=="variableList"}]),onClick:m[2]||(m[2]=d=>{s.value="variableList",c(o).emit("variableList")})}," VariableList ",2)):L("",!0),r.statusList?(i(),n("li",{key:3,class:g(["tab__item",{"tab__item--active":s.value=="statusList"}]),onClick:m[3]||(m[3]=d=>{s.value="statusList",c(o).emit("statusList")})}," StatusList ",2)):L("",!0)]),w(e("div",null,[e("div",nt,[e("div",rt,[p(et,{variableList:t.variableList},null,8,["variableList"])]),e("div",ct,[ut,e("div",dt,[p(c(H),{options:c(I).getOption(!0),data:c(y)},null,8,["options","data"])])])]),e("div",pt,[e("div",vt,[_t,e("div",mt,[p(c(H),{options:c(I).getOption(),data:c(_)},null,8,["options","data"])])])])],512),[[k,["MariaDB","MySQL"].includes(t.info.dbType)&&s.value=="dashBoard"]]),w(p(it,null,null,512),[[k,s.value=="processList"]]),w(e("div",null,[p(V,{data:t.variableList.rows,"cell-style":{height:"35px"},style:{width:"100%"},height:v()},{default:B(()=>[(i(!0),n(D,null,x(t.variableList.fields,(d,$)=>(i(),C(Q,{key:$,prop:d.name,label:d.name,align:"center"},null,8,["prop","label"]))),128))]),_:1},8,["data","height"])],512),[[k,t.info.dbType!="SqlServer"&&s.value=="variableList"]]),w(e("div",null,[p(V,{data:t.statusList.rows,"cell-style":{height:"35px"},style:{width:"100%"},height:v()},{default:B(()=>[(i(!0),n(D,null,x(t.statusList.fields,(d,$)=>(i(),C(Q,{key:$,prop:d.name,label:d.name,align:"center"},null,8,["prop","label"]))),128))]),_:1},8,["data","height"])],512),[[k,t.info.dbType!="SqlServer"&&s.value=="statusList"]])])}}});export{Qt as default};
